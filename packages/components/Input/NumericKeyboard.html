<div class="numeric-wrapper" class:focus="isFocused">

  {#if isFocused}
    Tem Focus
  {/if}

  <Input
    ref:inputNumeric
    bind:value
    autofocus
    forceFocus
    placeholder="Digite algum nÃºmero"
    on:focus="_openKeyboard()"
    on:blur="_closeKeyboard()"
  />

  <!-- {#if isFocused} -->
    <div class="keyboard">
      {#each new Array(9) as _, index}
        <button class="key" on:click="insertKey(event,index+1)">{index + 1}</button>
      {/each}

      <button class="key button">
        <img class="icon" src={deleteIcon} on:click="deleteKey()">
      </button>
      <button class="key" on:click="insertKey(event,0)">0</button>
      <button class="key button">
        <img class="icon" src={confirmIcon} on:click="confirm()">
      </button>
    </div>
  <!-- {/if} -->
</div>

<script>
  import deleteIcon from './assets/num_delete.png';
  import confirmIcon from './assets/num_ok.png';

  export default {
    components: {
      Input: '@mamba/input/Input.html',
    },
    helpers: {
      deleteIcon,
      confirmIcon,
    },
    data() {
      return {
        isFocused: false,
      };
    },
    oncreate() {
      this.set({
        value: '',
      });
    },
    onupdate() {
    },
    methods: {
      _forceFocus() {

        const { inputNumeric } = this.refs;

        inputNumeric.focus();
      },
      insertKey(event,key) {

        console.log(event);

        const { value } = this.get();

        this.set({
          value: value + key,
        });

        this._forceFocus();
      },
      deleteKey() {

        const { value } = this.get();

        if (!value) return;

        this.set({
          value: value.slice(0, -1),
        });

        this._forceFocus();
      },
      confirm() {
        this.fire('submit');
      },
      _openKeyboard() {

        this.set({
          isFocused: true,
        })
      },
      _closeKeyboard() {
        this.set({
          isFocused: false,
        })
      },
    },
  }
</script>

<style>
  .numeric-wrapper {
    /* css debug */
    /* border: 1px solid red; */
    position: relative;
    height: 91.4%;
  }

  .keyboard {
    width: 100%;
    max-height: 320px;
    box-sizing: border-box;
    padding: 7px 6px;
    /* css debug */
    /* border: 1px solid $gray500; */
    border-top: 1px solid $gray700;
    background-color: $neutral50;
    position: absolute;
    bottom: 0;

    * {
      box-sizing: border-box;
    }

    .key {
      max-width: 152px;
      width: 100%;
      height: 72px;
      border: 0;
      font-size: 35px;
      line-height: 41px;
      color: $neutral700;
      background-color: transparent;
    }

    .icon {
      max-width: 32px;
    }
  }
</style>
